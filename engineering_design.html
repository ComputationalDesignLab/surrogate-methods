

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Engineering Modeling and Design Optimization &#8212; AAE 590 Surrogate Methods</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'engineering_design';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Sequential Sampling using Dimensionality Reduction" href="dim_reduction/seq_sampling.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">AAE 590 Surrogate Methods</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="setup.html">Computing environment setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Python and Jupyter notebook resources</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="review_nm/intro.html">Review of Numerical Methods and Probability</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="review_nm/error.html">Error estimation for iterative method</a></li>
<li class="toctree-l2"><a class="reference internal" href="review_nm/num_diff.html">Numerical Differentiation</a></li>
<li class="toctree-l2"><a class="reference internal" href="review_nm/uniform.html">Uniform Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="review_nm/norm.html">Normal Distribution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="prob_form.html">Problem Formulation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="local_opt/intro.html">Local Optimization</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="local_opt/unconst.html">Unconstrained Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="local_opt/const.html">Constrained Optimization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="global_opt/intro.html">Global Optimization</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="global_opt/multi.html">Multistart Gradient-based Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="global_opt/pso.html">Particle Swarm Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="global_opt/de.html">Differential Evolution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="doe.html">Sampling Plans</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="basic_sm/intro.html">Basic Surrogate Models</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="basic_sm/ls_regression.html">Linear Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="basic_sm/poly.html">Polynomial Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="basic_sm/rbf.html">Radial Basis Function Model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="krg.html">Gaussian Process based Models</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="seq_sampling/intro.html">Sequential Sampling</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="seq_sampling/exploitation.html">Exploitation</a></li>
<li class="toctree-l2"><a class="reference internal" href="seq_sampling/exploration.html">Exploration</a></li>
<li class="toctree-l2"><a class="reference internal" href="seq_sampling/lcb.html">Lower Confidence Bound</a></li>
<li class="toctree-l2"><a class="reference internal" href="seq_sampling/pi.html">Probability of Improvement</a></li>
<li class="toctree-l2"><a class="reference internal" href="seq_sampling/ei.html">Expected Improvement</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="const_seq_sampling/intro.html">Constrained Sequential Sampling</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="const_seq_sampling/const_exploit.html">Constrained Exploitation</a></li>
<li class="toctree-l2"><a class="reference internal" href="const_seq_sampling/const_explor.html">Constrained Exploration</a></li>
<li class="toctree-l2"><a class="reference internal" href="const_seq_sampling/const_ei.html">Constrained Expected Improvement</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="sens_analysis/intro.html">Sensitivity Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="sens_analysis/local.html">Local Sensitivity Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="sens_analysis/global.html">Global Sensitivity Analysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="dim_reduction/intro.html">Dimensionality Reduction</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="dim_reduction/dim_red_methods.html">Dimensionality Reduction Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="dim_reduction/seq_sampling.html">Sequential Sampling using Dimensionality Reduction</a></li>
</ul>
</li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Engineering Modeling and Design Optimization</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/engineering_design.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Engineering Modeling and Design Optimization</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-a-noisy-function-using-regression-kriging">Modeling a noisy function using regression Kriging</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploitation-of-noisy-forrester-function">Exploitation of noisy Forrester function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-scaling-for-engineering-modeling">Data Scaling for engineering modeling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalization-scaling">Normalization Scaling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standardization-scaling">Standardization Scaling</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="engineering-modeling-and-design-optimization">
<h1>Engineering Modeling and Design Optimization<a class="headerlink" href="#engineering-modeling-and-design-optimization" title="Permalink to this heading">#</a></h1>
<p>This section demonstrates the use of surrogate-based design methods in solving problems that closely resemble those that are encountered in engineering. Such problems may include data that contains noise since not all processes encountered in engineering are deterministic. These problems may also include design variables that could have different scales that may make it difficult to apply surrogate modelling methods. The code blocks in this section will demonstrate how to apply surrogate modelling and design techniques in these situations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">smt.surrogate_models</span> <span class="kn">import</span> <span class="n">KRG</span><span class="p">,</span> <span class="n">RBF</span>
<span class="kn">from</span> <span class="nn">smt.problems</span> <span class="kn">import</span> <span class="n">TorsionVibration</span>
<span class="kn">from</span> <span class="nn">smt.sampling_methods</span> <span class="kn">import</span> <span class="n">LHS</span><span class="p">,</span> <span class="n">FullFactorial</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">from</span> <span class="nn">pymoo.core.problem</span> <span class="kn">import</span> <span class="n">Problem</span>
<span class="kn">from</span> <span class="nn">pymoo.algorithms.soo.nonconvex.de</span> <span class="kn">import</span> <span class="n">DE</span>
<span class="kn">from</span> <span class="nn">pymoo.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>
<span class="kn">from</span> <span class="nn">pymoo.config</span> <span class="kn">import</span> <span class="n">Config</span>
<span class="n">Config</span><span class="o">.</span><span class="n">warnings</span><span class="p">[</span><span class="s1">&#39;not_compiled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
</div>
<section id="modeling-a-noisy-function-using-regression-kriging">
<h2>Modeling a noisy function using regression Kriging<a class="headerlink" href="#modeling-a-noisy-function-using-regression-kriging" title="Permalink to this heading">#</a></h2>
<p>Often times, the data that is collected to model a function may be noisy. This noise could be due to the data being collected from an experiment and there is some randomness in the outcome of the experiment. In the code block below, the noisy version of the Forrester function is defined. This function is the Forrester function plus a simulated standard Gaussian noise term that is added to the function values. In this case, the function can be written as</p>
<div class="math notranslate nohighlight">
\[f(\textbf{x})=(6x-2)^2 \sin(12x-4)+\epsilon\]</div>
<div class="math notranslate nohighlight">
\[\epsilon \sim \mathcal{N}(0,1)\]</div>
<p>The block of code below defines the noisy Forrester function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defining the noisy forrester function</span>
<span class="n">forrester</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>  <span class="o">+</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">scale</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The block of code below generates training and testing data for the noisy forrester function. A Kriging model is created and fitted to the training data to make predictions for the noisy Forrester function. The number of samples in the training data are varied and plots are created to visualize the training data, predicted function values, true function values and the 95% confidence interval of the prediction.</p>
<p>In this case, the argument eval_noise is set to True while creating the Kriging model. This allows the model to account for the noise present in the data and fit a regression Kriging model that best fits the trend contained within the noisy data. This is in contrast with the regular Kriging model which is an interpolating model and passes through the training data points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting data</span>
<span class="n">xplot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">yplot</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">xplot</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">xplot</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Creating array of training sample sizes</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">40</span><span class="p">])</span>

<span class="c1"># Initializing nrmse list</span>
<span class="n">nrmse</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Fitting with different sample size</span>
<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
    
    <span class="n">xtrain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sample</span><span class="p">)</span>
    <span class="n">ytrain</span> <span class="o">=</span> <span class="n">forrester</span><span class="p">(</span><span class="n">xtrain</span><span class="p">)</span>
    
    <span class="c1"># Fitting the kriging</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">KRG</span><span class="p">(</span><span class="n">theta0</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-2</span><span class="p">],</span> <span class="n">corr</span><span class="o">=</span><span class="s1">&#39;matern52&#39;</span><span class="p">,</span> <span class="n">theta_bounds</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1e2</span><span class="p">],</span> <span class="n">print_global</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eval_noise</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">set_training_values</span><span class="p">(</span><span class="n">xtrain</span><span class="p">,</span> <span class="n">ytrain</span><span class="p">)</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    
    <span class="c1"># Predict at test values</span>
    <span class="n">yplot_pred</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">predict_values</span><span class="p">(</span><span class="n">xplot</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span>
    <span class="n">yplot_var</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">predict_variances</span><span class="p">(</span><span class="n">xplot</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span>

    <span class="c1"># Calculating average nrmse</span>
    <span class="n">nrmse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">yplot</span><span class="p">,</span> <span class="n">yplot_pred</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">yplot</span><span class="p">))</span>
    
    <span class="c1"># Plotting prediction</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtrain</span><span class="p">,</span> <span class="n">ytrain</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Noisy Training data&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True function&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot_pred</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot_pred</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">yplot_var</span><span class="p">),</span> <span class="n">yplot_pred</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">yplot_var</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;95% CI&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">yplot_pred</span><span class="p">,</span> <span class="n">yplot</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Prediction&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;True values&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Number of samples: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sample</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/eee55822360dd34008a2a40cfeba8a490f94d91b1db6f30cef397591de1b21c6.png" src="_images/eee55822360dd34008a2a40cfeba8a490f94d91b1db6f30cef397591de1b21c6.png" />
<img alt="_images/c654ce72acece7582b62a617da2bfb38fed19ec68838f9be0f52e8e055171922.png" src="_images/c654ce72acece7582b62a617da2bfb38fed19ec68838f9be0f52e8e055171922.png" />
<img alt="_images/7446ca8d86cd78b894fc26408818d885eaccb5d0f80cf08a1873a517dfc2c618.png" src="_images/7446ca8d86cd78b894fc26408818d885eaccb5d0f80cf08a1873a517dfc2c618.png" />
<img alt="_images/6988abc73e43698a1c8dde28070d20e25a1b7565f488eb095446bbbb1f10f065.png" src="_images/6988abc73e43698a1c8dde28070d20e25a1b7565f488eb095446bbbb1f10f065.png" />
<img alt="_images/af199ddb850646b85915775c411dd05e6e423b10b31b1d8819ffc2b2678e1728.png" src="_images/af199ddb850646b85915775c411dd05e6e423b10b31b1d8819ffc2b2678e1728.png" />
<img alt="_images/10e90c7bbec3af674deb46dd40563b7ad56925401772847c10227c345f1b84a4.png" src="_images/10e90c7bbec3af674deb46dd40563b7ad56925401772847c10227c345f1b84a4.png" />
<img alt="_images/28a604820402f0e1ed3a76cb3269d35e71594957539cf3382071f3b816a50e07.png" src="_images/28a604820402f0e1ed3a76cb3269d35e71594957539cf3382071f3b816a50e07.png" />
</div>
</div>
</section>
<section id="exploitation-of-noisy-forrester-function">
<h2>Exploitation of noisy Forrester function<a class="headerlink" href="#exploitation-of-noisy-forrester-function" title="Permalink to this heading">#</a></h2>
<p>The next blocks of code perform sequential sampling of the noisy Forrester function using exploitation. The regression Kriging model shown previously is used to create the model of the noisy function. This demonstrates finding the minimum of a noisy function that could be encountered in engineering scenarios.</p>
<p>The next block of code defines the Problem class and optimization algorithm for <code class="docutils literal notranslate"><span class="pre">pymoo</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Problem class</span>
<span class="k">class</span> <span class="nc">Exploitation</span><span class="p">(</span><span class="n">Problem</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sm</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">n_var</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_obj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_constr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xl</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span> <span class="n">xu</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sm</span> <span class="o">=</span> <span class="n">sm</span> <span class="c1"># store the surrogate model</span>

    <span class="k">def</span> <span class="nf">_evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="n">out</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sm</span><span class="o">.</span><span class="n">predict_values</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># Optimization algorithm</span>
<span class="n">algorithm</span> <span class="o">=</span> <span class="n">DE</span><span class="p">(</span><span class="n">pop_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">CR</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">dither</span><span class="o">=</span><span class="s2">&quot;vector&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The following block of code performs the sequential sampling of the noisy Forrester function using exploitation. The initial sampling plan has 5 samples generated that are linearly spaced in the design range. The maximum iterations are set to 20 and the tolerance of the algorithm is set to <span class="math notranslate nohighlight">\(10^{-3}\)</span>. The regression Kriging model is used as the surrogate for the noisy Forrester function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Training data</span>
<span class="n">num_train</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">xtrain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">num_train</span><span class="p">)</span>
<span class="n">ytrain</span> <span class="o">=</span> <span class="n">forrester</span><span class="p">(</span><span class="n">xtrain</span><span class="p">)</span>

<span class="c1"># Variables</span>
<span class="n">itr</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">max_itr</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">delta_f</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">corr</span> <span class="o">=</span> <span class="s1">&#39;squar_exp&#39;</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">12</span>

<span class="c1"># Sequential sampling Loop</span>
<span class="k">while</span> <span class="n">itr</span> <span class="o">&lt;</span> <span class="n">max_itr</span> <span class="ow">and</span> <span class="n">tol</span> <span class="o">&lt;</span> <span class="n">delta_f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Iteration </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">itr</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># Initializing the kriging model</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">KRG</span><span class="p">(</span><span class="n">theta0</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-2</span><span class="p">],</span> <span class="n">corr</span><span class="o">=</span><span class="n">corr</span><span class="p">,</span> <span class="n">theta_bounds</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1e2</span><span class="p">],</span> <span class="n">print_global</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eval_noise</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Setting the training values</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">set_training_values</span><span class="p">(</span><span class="n">xtrain</span><span class="p">,</span> <span class="n">ytrain</span><span class="p">)</span>
    
    <span class="c1"># Creating surrogate model</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

    <span class="c1"># Find the minimum of surrogate model</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">Exploitation</span><span class="p">(</span><span class="n">sm</span><span class="p">),</span> <span class="n">algorithm</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="c1"># Computing true function value at infill point</span>
    <span class="n">y_infill</span> <span class="o">=</span> <span class="n">forrester</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">itr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">delta_f</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">F</span> <span class="o">-</span> <span class="n">y_infill</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">F</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">delta_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">delta_f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">F</span> <span class="o">-</span> <span class="n">y_infill</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">F</span><span class="p">))</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Change in f: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">delta_f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f*: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y_infill</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x*: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">X</span><span class="p">))</span>
    
    <span class="c1"># Appending the the new point to the current data set</span>
    <span class="n">xtrain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xtrain</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">ytrain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">ytrain</span><span class="p">,</span> <span class="n">y_infill</span> <span class="p">)</span>
    
    <span class="n">itr</span> <span class="o">=</span> <span class="n">itr</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># Increasing the iteration number</span>

<span class="c1"># Printing the final results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Best obtained point:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x*: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xtrain</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">ytrain</span><span class="p">)]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f*: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ytrain</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration 1
Change in f: [[0.03057438]]
f*: [[-6.37943267]]
x*: [0.75]

Iteration 2
Change in f: 0.0658586339620523
f*: [[-6.97523368]]
x*: [0.75]

Iteration 3
Change in f: 0.02153290398662742
f*: [[-6.54189728]]
x*: [0.74999994]

Iteration 4
Change in f: 0.01759926517809217
f*: [[-6.76812825]]
x*: [0.75000041]

Iteration 5
Change in f: 0.19200230738319096
f*: [[-5.39341386]]
x*: [0.75000443]

Iteration 6
Change in f: 0.024088413461245056
f*: [[-6.60813471]]
x*: [0.74992689]

Iteration 7
Change in f: 0.1123329128244355
f*: [[-7.20404397]]
x*: [0.74972857]

Iteration 8
Change in f: 0.16302201959017956
f*: [[-5.51962057]]
x*: [0.74690746]

Iteration 9
Change in f: 0.36527018984914666
f*: [[-4.80012902]]
x*: [0.76011309]

Iteration 10
Change in f: 0.1594448846833556
f*: [[-5.53833287]]
x*: [0.7518286]

Iteration 11
Change in f: 0.1496011981938855
f*: [[-7.32135706]]
x*: [0.74921961]

Iteration 12
Change in f: 0.22721089770552338
f*: [[-5.0921604]]
x*: [0.74535829]

Iteration 13
Change in f: 0.1271164027174879
f*: [[-5.699324]]
x*: [0.7516507]

Iteration 14
Change in f: 0.3715523084126039
f*: [[-8.7833486]]
x*: [0.75123277]

Iteration 15
Change in f: 0.007372067812973327
f*: [[-6.69605098]]
x*: [0.75185381]

Iteration 16
Change in f: 0.16758347309616087
f*: [[-5.54343259]]
x*: [0.75188403]

Iteration 17
Change in f: 0.30250540428236977
f*: [[-4.55588142]]
x*: [0.75149415]

Iteration 18
Change in f: 0.2337051934485769
f*: [[-4.85982423]]
x*: [0.75056577]

Iteration 19
Change in f: 0.022038607192965996
f*: [[-6.37756998]]
x*: [0.72770982]

Iteration 20
Change in f: 0.03872181108092067
f*: [[-6.72539657]]
x*: [0.72751676]

Best obtained point:
x*: 0.7512327666010112
f*: -8.783348596765553
</pre></div>
</div>
</div>
</div>
<p>The exploitation algorithm is able to efficiently find the minimum of the Forrester function despite the noise in the function values. It can find the optimum <span class="math notranslate nohighlight">\(x^*\)</span> value within a few iterations, however, the <span class="math notranslate nohighlight">\(f^*\)</span> values are different due to the noise in the function. The noisy behaviour of the function can also prevent the exploitation algorithm from converging since convergence is based on changes in the function value.</p>
<p>The block of code below plots the true function, predicted function, initial samples and infill samples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Predict at test values</span>
<span class="n">yplot_pred</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">predict_values</span><span class="p">(</span><span class="n">xplot</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span>
<span class="n">yplot_var</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">predict_variances</span><span class="p">(</span><span class="n">xplot</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span>

<span class="c1"># Plotting prediction and infill points</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtrain</span><span class="p">[:</span><span class="n">num_train</span><span class="p">],</span> <span class="n">ytrain</span><span class="p">[:</span><span class="n">num_train</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Initial data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtrain</span><span class="p">[</span><span class="n">num_train</span><span class="p">:],</span> <span class="n">ytrain</span><span class="p">[</span><span class="n">num_train</span><span class="p">:],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Infills&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtrain</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">ytrain</span><span class="p">)],</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ytrain</span><span class="p">),</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Optimum point&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True function&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot_pred</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot_pred</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">yplot_var</span><span class="p">),</span> <span class="n">yplot_pred</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">yplot_var</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;95% CI&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x174dd9970&gt;
</pre></div>
</div>
<img alt="_images/2ec4efbc4726f83add4d7ef594c700d3c86756428d3c251ec25e172fe58b3bf6.png" src="_images/2ec4efbc4726f83add4d7ef594c700d3c86756428d3c251ec25e172fe58b3bf6.png" />
</div>
</div>
</section>
<section id="data-scaling-for-engineering-modeling">
<h2>Data Scaling for engineering modeling<a class="headerlink" href="#data-scaling-for-engineering-modeling" title="Permalink to this heading">#</a></h2>
<p>While working with data obtained in engineering work, the design variables or features of the data may have vastly different magnitudes. For example, when working with data from engineering structures, stress-related quantities could be on the order of <span class="math notranslate nohighlight">\(10^6\)</span> Pa while the dimensions of the structure could be on the order of <span class="math notranslate nohighlight">\(10^{-3}\)</span> m. The design variables in this case vary by several orders of magnitude. Due to the large variation in the orders of magnitude in the data, it can be hard to use it to create a surrogate model directly. Typically, it is hard to train the models when the design variables can vary by several orders of magnitude. To make it easier to create surrogate models in such situations, scaling is applied to the design variables to bring each design variable to the same order of magnitude or within the same range of values.</p>
<p>To demonstrate the use of scaling, the <a class="reference external" href="https://smt.readthedocs.io/en/latest/_src_docs/problems/torsionvibration.html">Torsion Vibration</a> function will be used. It is a 15-dimensional function with the values of design variables varying from the order of <span class="math notranslate nohighlight">\(10^7\)</span> to <span class="math notranslate nohighlight">\(10^{-2}\)</span>. The function is high-dimensional and the design variables have a large variation in order of magnitude. Radial basis function (RBF) models will be used to model the <a class="reference external" href="https://smt.readthedocs.io/en/latest/_src_docs/problems/torsionvibration.html">Torsion Vibration</a> problem. Normalization and Standardization scaling will be applied to the data of the function and the NRMSE of the prediction of the model will be calculated for different numbers of training samples.</p>
<p>The block of code below defines the <a class="reference external" href="https://smt.readthedocs.io/en/latest/_src_docs/problems/torsionvibration.html">Torsion Vibration</a> function implemented in SMT.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defining the Torsion Vibration problem</span>
<span class="n">ndim</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">TorsionVibration</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Since RBF models are used for this section, a function is defined to find the best <span class="math notranslate nohighlight">\(\sigma\)</span> for the RBF model for given training and testing data. This function is similar to the one seen earlier in the Jupyter book with the addition of two arguments providing the scaling methods for the input and output data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_sigma</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">sigmas</span><span class="p">,</span> <span class="n">x_scaler</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">y_scaler</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function finds the best sigma for a RBF model by fitting the model to the training data and</span>
<span class="sd">    evaluating it on testing data. The best sigma is the one that achieves minimum normalized RMSE.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x_train : numpy array</span>
<span class="sd">        Training data x values</span>
<span class="sd">    y_train : numpy array</span>
<span class="sd">        Training data y values</span>
<span class="sd">    x_test : numpy array</span>
<span class="sd">        Testing data x values</span>
<span class="sd">    y_test : numpy array</span>
<span class="sd">        Testing data y values</span>
<span class="sd">    sigmas : numpy array</span>
<span class="sd">        Sigmas to be tested</span>
<span class="sd">    x_scaler: sklearn scaler object for x_train</span>
<span class="sd">    y_scler: sklearn scaler object for y_train</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    best_sigma : float</span>
<span class="sd">        Best sigma value</span>
<span class="sd">    metric : list</span>
<span class="sd">        List of NRMSE values for each sigma</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Initializing normalized RMSE list</span>
    <span class="n">metric</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Fitting various polynomials</span>
    <span class="k">for</span> <span class="n">sigma</span> <span class="ow">in</span> <span class="n">sigmas</span><span class="p">:</span>

        <span class="c1"># Fit the RBF to current fold</span>
        <span class="n">sm</span> <span class="o">=</span> <span class="n">RBF</span><span class="p">(</span><span class="n">d0</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">poly_degree</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">print_global</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">sm</span><span class="o">.</span><span class="n">set_training_values</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">sm</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

        <span class="c1"># Predict at test values</span>
        <span class="k">if</span> <span class="n">x_scaler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y_scaler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">predict_values</span><span class="p">(</span><span class="n">x_scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">))</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">predict_values</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>

        <span class="c1"># Adding all the rmse to calculate average later</span>
        <span class="n">nrmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
            
        <span class="c1"># Calculating average nrmse</span>
        <span class="n">metric</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nrmse</span><span class="p">)</span>

    <span class="n">best_sigma</span> <span class="o">=</span> <span class="n">sigmas</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">metric</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">best_sigma</span><span class="p">,</span> <span class="n">metric</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="normalization-scaling">
<h2>Normalization Scaling<a class="headerlink" href="#normalization-scaling" title="Permalink to this heading">#</a></h2>
<p>Normalization scales all of the design variables to a specified range using the minimum and maximum values of the variables in the data. The first step of normalization is to scale the variables to a range of <span class="math notranslate nohighlight">\([0,1]\)</span> using the minimum and maximum values. This scaling can be obtained as</p>
<div class="math notranslate nohighlight">
\[X_{std} = \frac{X-X_{min}}{X_{max}-X_{min}}\]</div>
<p>where <span class="math notranslate nohighlight">\(X\)</span> is the input/output data for the model and <span class="math notranslate nohighlight">\(X_{min}\)</span> and <span class="math notranslate nohighlight">\(X_{max}\)</span> are the minimum and maximum values of the input/output features. If the desired range for the data is <span class="math notranslate nohighlight">\([0,1]\)</span>, then no further steps are required. However, if the desired range for the data is <span class="math notranslate nohighlight">\([\min, \max]\)</span>, then <span class="math notranslate nohighlight">\(X_{std}\)</span> must be further scaled to the required range</p>
<div class="math notranslate nohighlight">
\[X_{scaled}=X_{std}(\text{max} - \text{min}) + \text{min}\]</div>
<p>The block of code below uses the MinMaxScaler from <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> to normalize the data obtained for the Torsion Vibration function. An RBF model is fit to both the scaled and unscaled data for different numbers of training samples. Predictions are made on the testing data for the function and the NRMSE values are calculated for the predictions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating testing data for the problem</span>
<span class="n">test_sampler</span> <span class="o">=</span> <span class="n">FullFactorial</span><span class="p">(</span><span class="n">xlimits</span><span class="o">=</span><span class="n">problem</span><span class="o">.</span><span class="n">xlimits</span><span class="p">)</span>
<span class="n">num_test</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">xtest</span> <span class="o">=</span> <span class="n">test_sampler</span><span class="p">(</span><span class="n">num_test</span><span class="p">)</span>
<span class="n">ytest</span> <span class="o">=</span> <span class="n">problem</span><span class="p">(</span><span class="n">xtest</span><span class="p">)</span>

<span class="c1"># Standard scaling</span>
<span class="n">xmm_scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">ymm_scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>

<span class="c1"># Fitting with different sample size</span>
<span class="n">train_sampler</span> <span class="o">=</span> <span class="n">LHS</span><span class="p">(</span><span class="n">xlimits</span><span class="o">=</span><span class="n">problem</span><span class="o">.</span><span class="n">xlimits</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;ese&quot;</span><span class="p">)</span>

<span class="c1"># Defining the number of samples</span>
<span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>

<span class="n">scaled_nrmse</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">nrmse</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
    <span class="c1"># Creating a model with and without scaling</span>
    <span class="n">num</span> <span class="o">=</span> <span class="n">sample</span>
    <span class="n">xtrain</span> <span class="o">=</span> <span class="n">train_sampler</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="n">ytrain</span> <span class="o">=</span> <span class="n">problem</span><span class="p">(</span><span class="n">xtrain</span><span class="p">)</span>
    
    <span class="n">xtrain_scaled</span> <span class="o">=</span> <span class="n">xmm_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">xtrain</span><span class="p">)</span>
    <span class="n">ytrain_scaled</span> <span class="o">=</span> <span class="n">ymm_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">ytrain</span><span class="p">)</span>
    
    <span class="n">sigmas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">best_sigma</span><span class="p">,</span> <span class="n">test_metric</span> <span class="o">=</span> <span class="n">find_sigma</span><span class="p">(</span><span class="n">xtrain</span><span class="p">,</span> <span class="n">ytrain</span><span class="p">,</span> <span class="n">xtest</span><span class="p">,</span> <span class="n">ytest</span><span class="p">,</span> <span class="n">sigmas</span><span class="p">,</span> <span class="n">x_scaler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_scaler</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">best_sigma_scaled</span><span class="p">,</span> <span class="n">test_metric_scaled</span> <span class="o">=</span> <span class="n">find_sigma</span><span class="p">(</span><span class="n">xtrain_scaled</span><span class="p">,</span> <span class="n">ytrain_scaled</span><span class="p">,</span> <span class="n">xtest</span><span class="p">,</span> <span class="n">ytest</span><span class="p">,</span> <span class="n">sigmas</span><span class="p">,</span> <span class="n">xmm_scaler</span><span class="p">,</span> <span class="n">ymm_scaler</span><span class="p">)</span>
    
    <span class="c1"># Fitting RBF using scaled data</span>
    <span class="n">sm_scaled</span> <span class="o">=</span> <span class="n">RBF</span><span class="p">(</span><span class="n">d0</span><span class="o">=</span><span class="n">best_sigma_scaled</span><span class="p">,</span> <span class="n">print_global</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">sm_scaled</span><span class="o">.</span><span class="n">set_training_values</span><span class="p">(</span><span class="n">xtrain_scaled</span><span class="p">,</span> <span class="n">ytrain_scaled</span><span class="p">)</span>
    <span class="n">sm_scaled</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    
    <span class="c1"># Fitting RBF using unscaled data</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">RBF</span><span class="p">(</span><span class="n">d0</span><span class="o">=</span><span class="n">best_sigma</span><span class="p">,</span> <span class="n">print_global</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">set_training_values</span><span class="p">(</span><span class="n">xtrain</span><span class="p">,</span> <span class="n">ytrain</span><span class="p">)</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    
    <span class="c1"># Predicting on test data</span>
    <span class="n">ypred_scaled</span> <span class="o">=</span> <span class="n">sm_scaled</span><span class="o">.</span><span class="n">predict_values</span><span class="p">(</span><span class="n">xmm_scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">xtest</span><span class="p">))</span>
    <span class="n">ypred_scaled</span> <span class="o">=</span> <span class="n">ymm_scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">ypred_scaled</span><span class="p">)</span>
    <span class="n">ypred</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">predict_values</span><span class="p">(</span><span class="n">xtest</span><span class="p">)</span>

    <span class="n">scaled_nrmse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">ytest</span><span class="p">,</span> <span class="n">ypred_scaled</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">ytest</span><span class="p">))</span>
    <span class="n">nrmse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">ytest</span><span class="p">,</span> <span class="n">ypred</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">ytest</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>The next block of code will plot the NRMSE values against the number of training samples for both the scaled and unscaled data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting NMRSE</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nrmse</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Unscaled Data&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scaled_nrmse</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Scaled Data&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Number of samples&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Normalized RMSE&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Normalized RMSE&#39;)
</pre></div>
</div>
<img alt="_images/d5ab1e2ea3a7740fc18e2ace016a4fc0a7177e6527079df3b39282f2feec89ce.png" src="_images/d5ab1e2ea3a7740fc18e2ace016a4fc0a7177e6527079df3b39282f2feec89ce.png" />
</div>
</div>
<p>The plot above shows that using the scaled data to create the model consistently leads to lower NRMSE values than the model created using the unscaled data. It is difficult to train the model using the unscaled data and there is little improvement in the NRMSE values as the number of samples increases.</p>
</section>
<section id="standardization-scaling">
<h2>Standardization Scaling<a class="headerlink" href="#standardization-scaling" title="Permalink to this heading">#</a></h2>
<p>Standardization scales the data to be of mean 0 and standard deviation 1. The first step of the scaling is to calculate the mean (<span class="math notranslate nohighlight">\(\mu\)</span>) and standard deviation (<span class="math notranslate nohighlight">\(\sigma\)</span>) of each feature in the input or output data. Once the <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> are calculated, the data can be scaled as</p>
<div class="math notranslate nohighlight">
\[X_{scaled} = \frac{X-\mu}{\sigma}\]</div>
<p>The block of code below uses the StandardScaler from <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> to normalize the data obtained for the Torsion Vibration function. An RBF model is fit to both the scaled and unscaled data for different numbers of training samples. Predictions are made on the testing data for the function and the NRMSE values are calculated for the predictions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating testing data for the problem</span>
<span class="n">test_sampler</span> <span class="o">=</span> <span class="n">FullFactorial</span><span class="p">(</span><span class="n">xlimits</span><span class="o">=</span><span class="n">problem</span><span class="o">.</span><span class="n">xlimits</span><span class="p">)</span>
<span class="n">num_test</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">xtest</span> <span class="o">=</span> <span class="n">test_sampler</span><span class="p">(</span><span class="n">num_test</span><span class="p">)</span>
<span class="n">ytest</span> <span class="o">=</span> <span class="n">problem</span><span class="p">(</span><span class="n">xtest</span><span class="p">)</span>

<span class="c1"># Standard scaling</span>
<span class="n">xstd_scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">ystd_scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="c1"># Fitting with different sample size</span>
<span class="n">train_sampler</span> <span class="o">=</span> <span class="n">LHS</span><span class="p">(</span><span class="n">xlimits</span><span class="o">=</span><span class="n">problem</span><span class="o">.</span><span class="n">xlimits</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;ese&quot;</span><span class="p">)</span>

<span class="c1"># Defining the number of samples</span>
<span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>

<span class="n">scaled_nrmse</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">nrmse</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
    <span class="c1"># Creating a model with and without scaling</span>
    <span class="n">num</span> <span class="o">=</span> <span class="n">sample</span>
    <span class="n">xtrain</span> <span class="o">=</span> <span class="n">train_sampler</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="n">ytrain</span> <span class="o">=</span> <span class="n">problem</span><span class="p">(</span><span class="n">xtrain</span><span class="p">)</span>
    
    <span class="n">xtrain_scaled</span> <span class="o">=</span> <span class="n">xstd_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">xtrain</span><span class="p">)</span>
    <span class="n">ytrain_scaled</span> <span class="o">=</span> <span class="n">ystd_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">ytrain</span><span class="p">)</span>
    
    <span class="n">sigmas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">best_sigma</span><span class="p">,</span> <span class="n">test_metric</span> <span class="o">=</span> <span class="n">find_sigma</span><span class="p">(</span><span class="n">xtrain</span><span class="p">,</span> <span class="n">ytrain</span><span class="p">,</span> <span class="n">xtest</span><span class="p">,</span> <span class="n">ytest</span><span class="p">,</span> <span class="n">sigmas</span><span class="p">,</span> <span class="n">x_scaler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_scaler</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">best_sigma_scaled</span><span class="p">,</span> <span class="n">test_metric_scaled</span> <span class="o">=</span> <span class="n">find_sigma</span><span class="p">(</span><span class="n">xtrain_scaled</span><span class="p">,</span> <span class="n">ytrain_scaled</span><span class="p">,</span> <span class="n">xtest</span><span class="p">,</span> <span class="n">ytest</span><span class="p">,</span> <span class="n">sigmas</span><span class="p">,</span> <span class="n">xstd_scaler</span><span class="p">,</span> <span class="n">ystd_scaler</span><span class="p">)</span>
    
    <span class="c1"># Fitting RBF using scaled data</span>
    <span class="n">sm_scaled</span> <span class="o">=</span> <span class="n">RBF</span><span class="p">(</span><span class="n">d0</span><span class="o">=</span><span class="n">best_sigma_scaled</span><span class="p">,</span> <span class="n">print_global</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">sm_scaled</span><span class="o">.</span><span class="n">set_training_values</span><span class="p">(</span><span class="n">xtrain_scaled</span><span class="p">,</span> <span class="n">ytrain_scaled</span><span class="p">)</span>
    <span class="n">sm_scaled</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    
    <span class="c1"># Fitting RBF using unscaled data</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">RBF</span><span class="p">(</span><span class="n">d0</span><span class="o">=</span><span class="n">best_sigma</span><span class="p">,</span> <span class="n">print_global</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">set_training_values</span><span class="p">(</span><span class="n">xtrain</span><span class="p">,</span> <span class="n">ytrain</span><span class="p">)</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    
    <span class="c1"># Predicting on test data</span>
    <span class="n">ypred_scaled</span> <span class="o">=</span> <span class="n">sm_scaled</span><span class="o">.</span><span class="n">predict_values</span><span class="p">(</span><span class="n">xstd_scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">xtest</span><span class="p">))</span>
    <span class="n">ypred_scaled</span> <span class="o">=</span> <span class="n">ystd_scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">ypred_scaled</span><span class="p">)</span>
    <span class="n">ypred</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">predict_values</span><span class="p">(</span><span class="n">xtest</span><span class="p">)</span>

    <span class="n">scaled_nrmse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">ytest</span><span class="p">,</span> <span class="n">ypred_scaled</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">ytest</span><span class="p">))</span>
    <span class="n">nrmse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">ytest</span><span class="p">,</span> <span class="n">ypred</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">ytest</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>The next block of code will plot the NRMSE values against the number of training samples for both the scaled and unscaled data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting NMRSE</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nrmse</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Unscaled Data&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scaled_nrmse</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Scaled Data&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Number of samples&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Normalized RMSE&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Normalized RMSE&#39;)
</pre></div>
</div>
<img alt="_images/1fea9c77c06dd5eecf997e969a35517a108bdb3b584f47724088e1378bd7b0cb.png" src="_images/1fea9c77c06dd5eecf997e969a35517a108bdb3b584f47724088e1378bd7b0cb.png" />
</div>
</div>
<p>Similar to normalization, the plot above shows that using the scaled data to create the model consistently leads to lower NRMSE values than the model created using the unscaled data. It is difficult to train the model using the unscaled data and there is little improvement in the NRMSE values as the number of samples increases.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="dim_reduction/seq_sampling.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Sequential Sampling using Dimensionality Reduction</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-a-noisy-function-using-regression-kriging">Modeling a noisy function using regression Kriging</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploitation-of-noisy-forrester-function">Exploitation of noisy Forrester function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-scaling-for-engineering-modeling">Data Scaling for engineering modeling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalization-scaling">Normalization Scaling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standardization-scaling">Standardization Scaling</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Leifur Leifsson (leifur[at]purdue.edu)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>